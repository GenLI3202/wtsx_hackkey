{
    "_specification": {
        "name": "Module D Optimizer Service Input Format",
        "version": "1.1",
        "description": "Standard input format for Module D (Optimizer Service)",
        "format": "Pandas DataFrame JSON export (dict orientation)",
        "sources": {
            "market_prices": "Module B (Price Service) / GridKey existing data",
            "generation_forecast": "Module A (Weather Service) [NEW for renewable integration]",
            "battery_config": "Config file"
        }
    },
    "metadata": {
        "country": "CZ",
        "time_horizon_hours": 3,
        "num_timesteps": 12,
        "resolution_minutes": 15,
        "model_type": "III-renew",
        "c_rate": 0.5,
        "alpha": 1.0
    },
    "data_slice": {
        "_description": "Market data in Pandas DataFrame dict format (index: value pairs)",
        "_note": "This is the EXISTING format from GridKey preprocessed data",
        "price_day_ahead": {
            "_unit": "EUR/MWh",
            "_resolution": "15 minutes",
            "0": 54.89,
            "1": 54.89,
            "2": 54.89,
            "3": 54.89,
            "4": 44.73,
            "5": 44.73,
            "6": 44.73,
            "7": 44.73,
            "8": 41.47,
            "9": 41.47,
            "10": 41.47,
            "11": 41.47
        },
        "price_fcr": {
            "_unit": "EUR/MW per 4-hour block (forward-filled to 15-min)",
            "_resolution": "15 minutes (from 4-hour blocks)",
            "0": 38.52,
            "1": 38.52,
            "2": 38.52,
            "3": 38.52,
            "4": 38.52,
            "5": 38.52,
            "6": 38.52,
            "7": 38.52,
            "8": 38.52,
            "9": 38.52,
            "10": 38.52,
            "11": 38.52
        },
        "price_afrr_pos": {
            "_unit": "EUR/MW per 4-hour block (forward-filled to 15-min)",
            "_resolution": "15 minutes (from 4-hour blocks)",
            "0": 14.4526040816,
            "1": 14.4526040816,
            "2": 14.4526040816,
            "3": 14.4526040816,
            "4": 14.4526040816,
            "5": 14.4526040816,
            "6": 14.4526040816,
            "7": 14.4526040816,
            "8": 14.4526040816,
            "9": 14.4526040816,
            "10": 14.4526040816,
            "11": 14.4526040816
        },
        "price_afrr_neg": {
            "_unit": "EUR/MW per 4-hour block (forward-filled to 15-min)",
            "_resolution": "15 minutes (from 4-hour blocks)",
            "0": 0.6240747875,
            "1": 0.6240747875,
            "2": 0.6240747875,
            "3": 0.6240747875,
            "4": 0.6240747875,
            "5": 0.6240747875,
            "6": 0.6240747875,
            "7": 0.6240747875,
            "8": 0.6240747875,
            "9": 0.6240747875,
            "10": 0.6240747875,
            "11": 0.6240747875
        },
        "price_afrr_energy_pos": {
            "_unit": "EUR/MWh, null = market NOT activated",
            "_resolution": "15 minutes",
            "0": 127.29,
            "1": 101.87,
            "2": 5.42,
            "3": null,
            "4": 18.79,
            "5": null,
            "6": null,
            "7": null,
            "8": 49.33,
            "9": 6.49,
            "10": 85.45,
            "11": 75.01
        },
        "price_afrr_energy_neg": {
            "_unit": "EUR/MWh, null = market NOT activated",
            "_resolution": "15 minutes",
            "0": 56.9,
            "1": null,
            "2": null,
            "3": null,
            "4": null,
            "5": null,
            "6": null,
            "7": null,
            "8": null,
            "9": null,
            "10": 50.86,
            "11": 109.74
        },
        "w_afrr_pos": {
            "_unit": "dimensionless (0-1)",
            "_description": "aFRR+ activation probability weight (EV weighting)",
            "0": 0.9676,
            "1": 0.9676,
            "2": 0.9676,
            "3": 0.9676,
            "4": 0.9676,
            "5": 0.9676,
            "6": 0.9676,
            "7": 0.9676,
            "8": 0.9676,
            "9": 0.9676,
            "10": 0.9676,
            "11": 0.9676
        },
        "w_afrr_neg": {
            "_unit": "dimensionless (0-1)",
            "_description": "aFRR- activation probability weight (EV weighting)",
            "0": 0.7623,
            "1": 0.7623,
            "2": 0.7623,
            "3": 0.7623,
            "4": 0.7623,
            "5": 0.7623,
            "6": 0.7623,
            "7": 0.7623,
            "8": 0.7623,
            "9": 0.7623,
            "10": 0.7623,
            "11": 0.7623
        },
        "hour": {
            "_description": "Hour of day (0-23)",
            "0": 0,
            "1": 0,
            "2": 0,
            "3": 0,
            "4": 1,
            "5": 1,
            "6": 1,
            "7": 1,
            "8": 2,
            "9": 2,
            "10": 2,
            "11": 2
        },
        "day_of_year": {
            "_description": "Day of year (1-366)",
            "0": 133,
            "1": 133,
            "2": 133,
            "3": 133,
            "4": 133,
            "5": 133,
            "6": 133,
            "7": 133,
            "8": 133,
            "9": 133,
            "10": 133,
            "11": 133
        },
        "month": {
            "_description": "Month (1-12)",
            "0": 5,
            "1": 5,
            "2": 5,
            "3": 5,
            "4": 5,
            "5": 5,
            "6": 5,
            "7": 5,
            "8": 5,
            "9": 5,
            "10": 5,
            "11": 5
        },
        "year": {
            "_description": "Year",
            "0": 2024,
            "1": 2024,
            "2": 2024,
            "3": 2024,
            "4": 2024,
            "5": 2024,
            "6": 2024,
            "7": 2024,
            "8": 2024,
            "9": 2024,
            "10": 2024,
            "11": 2024
        },
        "block_of_day": {
            "_description": "4-hour block within day (0-5)",
            "0": 0,
            "1": 0,
            "2": 0,
            "3": 0,
            "4": 0,
            "5": 0,
            "6": 0,
            "7": 0,
            "8": 0,
            "9": 0,
            "10": 0,
            "11": 0
        },
        "block_id": {
            "_description": "Global block ID across dataset",
            "0": 792,
            "1": 792,
            "2": 792,
            "3": 792,
            "4": 792,
            "5": 792,
            "6": 792,
            "7": 792,
            "8": 792,
            "9": 792,
            "10": 792,
            "11": 792
        },
        "day_id": {
            "_description": "Day ID (same as day_of_year)",
            "0": 133,
            "1": 133,
            "2": 133,
            "3": 133,
            "4": 133,
            "5": 133,
            "6": 133,
            "7": 133,
            "8": 133,
            "9": 133,
            "10": 133,
            "11": 133
        },
        "timestamp": {
            "_description": "Unix timestamp (seconds since 1970-01-01)",
            "0": 1715472000,
            "1": 1715472900,
            "2": 1715473800,
            "3": 1715474700,
            "4": 1715475600,
            "5": 1715476500,
            "6": 1715477400,
            "7": 1715478300,
            "8": 1715479200,
            "9": 1715480100,
            "10": 1715481000,
            "11": 1715481900
        },
        "_NEW_RENEWABLE_FIELD_": "=== Added for Model III-renew ===",
        "p_renewable_forecast_kw": {
            "_unit": "kW",
            "_description": "Total renewable generation forecast (PV + Wind) from Module A",
            "_source": "Module A (Weather Service)",
            "_null_when": "No renewable integration (Model I/II/III)",
            "0": null,
            "1": null,
            "2": null,
            "3": null,
            "4": null,
            "5": null,
            "6": null,
            "7": null,
            "8": null,
            "9": null,
            "10": null,
            "11": null
        }
    },
    "battery_config": {
        "_source": "Config file",
        "capacity_kwh": 4472,
        "c_rate": 0.5,
        "max_power_kw": 2236,
        "efficiency": 0.95,
        "initial_soc": 0.5,
        "soh": 1.0
    },
    "_field_specification": {
        "EXISTING_FIELDS": {
            "price_day_ahead": "DA spot price (EUR/MWh)",
            "price_fcr": "FCR capacity price, forward-filled from 4h blocks (EUR/MW)",
            "price_afrr_pos": "aFRR+ capacity price, forward-filled (EUR/MW)",
            "price_afrr_neg": "aFRR- capacity price, forward-filled (EUR/MW)",
            "price_afrr_energy_pos": "aFRR+ energy price, null=not activated (EUR/MWh)",
            "price_afrr_energy_neg": "aFRR- energy price, null=not activated (EUR/MWh)",
            "w_afrr_pos": "aFRR+ activation probability weight",
            "w_afrr_neg": "aFRR- activation probability weight",
            "hour": "Hour of day (0-23)",
            "day_of_year": "Day of year (1-366)",
            "month": "Month (1-12)",
            "year": "Year",
            "block_of_day": "4-hour block index within day (0-5)",
            "block_id": "Global block ID",
            "day_id": "Day ID",
            "timestamp": "Unix timestamp (seconds)"
        },
        "NEW_RENEWABLE_FIELD": {
            "p_renewable_forecast_kw": {
                "type": "float|null",
                "source": "Module A (Weather Service)",
                "desc": "Total renewable generation forecast = PV + Wind (kW)",
                "null_when": "Model does not include renewable integration"
            }
        }
    },
    "_integration_notes": {
        "format": "Pandas DataFrame.to_json() with orient='dict' (default)",
        "Module_A_responsibility": "Provide p_renewable_forecast_kw array at 15-min resolution",
        "Module_B_responsibility": "Provide all price_* fields in existing format",
        "null_semantics": "null in price_afrr_energy_* means market NOT activated"
    }
}